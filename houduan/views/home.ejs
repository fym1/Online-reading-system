<!DOCTYPE html>
<html>
    <head>
        <title>home</title>
        <link rel='stylesheet' href='/stylesheets/style.css'/>
        <link rel='stylesheet' href='/stylesheets/home.css'/>
    </head>
    <body class="bg">
        <header style="width:100%;height:140px;"> 
          <img src="./images/logo.png" style="width:120px;height:120px;float:left;margin-left: 30px;"/>
          <p style="float:left;color:white;font-size:42px;line-height:130px;margin-left:40px;">图文期刊在线阅读管理系统</p>
        </header>
        <div class="left">
            <div class="nav" style="background: rgba(255,255,255,0.5);">
                <a href="/home">首页</a>
            </div>
            <div class="nav">
                <a href="/user">用户管理</a>
            </div>
            <div class="nav">
                <a href="/block">评论管理</a>
            </div>
            <div class="nav">
                <a href="/book">期刊管理</a>
            </div>
            <div class="nav">
                <a href="/score">积分管理</a>
            </div>
            <div class="nav">
                <a href="/system">系统管理</a>
            </div>
        </div>
        <div class="right">
            <div class="boxcenter">
                <div class="box1" id='#box1' style='transition:all 0.5s;
                cursor:pointer;'>
                    <div class="box11">
                        <p style="color: white;">日注册用户数</p>
                    </div>
                    <p class="box121" id='b1'><%= userListnew.length%></p> 
                    <div class="box122">
                    </div>  
                    <div class="box123">
                    </div>  
                </div>
                <div class="box2">
                    <div class="box11">
                        <p style="color: white;">累计用户数量</p>
                    </div>
                    <p class="box121" id='b2'><%= userListall.length%></p> 
                    <div class="box122">
                    </div>  
                    <div class="box123">
                    </div>  
                </div>
                <div class="box3">
                    <div class="box11">
                        <p style="color: white;">总图文期刊数</p>
                    </div>
                    <p class="box121" id='b3'><%= bookList.length%></p> 
                    <div class="box122">
                    </div>  
                    <div class="box123">
                    </div>  
                </div>
        </div>
    </body>
    <script src="https://cdn.staticfile.org/jquery/1.10.2/jquery.min.js"></script>
    <script type="text/javascript"></script>
    <script>
        // console.log(bookList);
        var numstr1 =$('#b1').html();
        var numstr2 =$('#b2').html();
        var numstr =$('#b3').html();
        numGrow1($('#b1'), numstr1, 4000, 20);
        numGrow2($('#b2'), numstr2, 1000000, 20);
        numGrow($('#b3'), numstr, 1000000, 20);
        //数字增长
        function numGrow(obj, str, time, delay) {
            var num = numstr.replace(/[^0-9]/ig, "");
            var g = 0;
            obj.text(g);
            var step = Math.ceil(num / (time / delay));
            var time = setInterval(function() {
                if (g <= num - step) {
                    g += step;
                } else {
                    g = num;
                }
                obj.text(formatNum(g.toString()));
                if (g >= num) {
                    clearInterval(time);
                    return;
                }
            }, delay);
        }
        function numGrow2(obj, str, time, delay) {
            var num = numstr2.replace(/[^0-9]/ig, "");
            var g = 0;
            obj.text(g);
            var step = Math.ceil(num / (time / delay));
            var time = setInterval(function() {
                if (g <= num - step) {
                    g += step;
                } else {
                    g = num;
                }
                obj.text(formatNum(g.toString()));
                if (g >= num) {
                    clearInterval(time);
                    return;
                }
            }, delay);
        }
        function numGrow1(obj, str, time, delay) {
            var num = numstr1.replace(/[^0-9]/ig, "");
            var g = 0;
            obj.text(g);
            var step = Math.ceil(num / (time / delay));
            var time = setInterval(function() {
                if (g <= num - step) {
                    g += step;
                } else {
                    g = num;
                }
                obj.text(formatNum(g.toString()));
                if (g >= num) {
                    clearInterval(time);
                    return;
                }
            }, delay);
        }
        //数值处理
        function formatNum(str) {
            var newStr = "";
            var count = 0;
            for (var i = str.length - 1; i >= 0; i--) {
                if (count % 3 == 0 && count != 0) {
                    newStr = str.charAt(i) + "," + newStr;
                } else {
                    newStr = str.charAt(i) + newStr;
                }
                count++;
            }
            return newStr;
        }
    </script>
</html>
